{% extends "network/layout.html" %}
{% load humanize %}
{% load static %}

{% block body %}
<h3 class="text-center" style="font-family: 'Roboto', sans-serif; margin-bottom: 1em;">Profile</h3>

<!--Profile user header-->
<div class="container">
  <div class="col-12 col-lg-12 border my-2 p-4 bg-white box-shadow" style="border-radius: 10px; box-shadow: 0 7px 9px rgba(0, 0, 0, 0.2);">
    <section class="container">
      <!--Image-->
        <img alt="profile picture" height="109" width="111px" href="" style="display: inline; margin-right: 3.5rem; margin-bottom: 1rem;"
        src="{% if user_profile.username == 'john' %}{% static 'network/prof-images/john-2.png' %}
        {% else %}
        {% static 'network/images/owl-silhouette.png' %}
        {% endif %}">
      <!--Display Num Hoots -->
      <span style="display: inline; padding: 1.5rem; font-weight: bold;">
          {{ user_profile.posts.count }} Hoots
      </span>  
      <!--Display Followers -->
      <span style="display: inline; padding: 1.5rem; font-weight: bold;" type="button" class="number-stat" data-toggle="modal" data-target="#exampleModal">
        {{ user_profile.followers.count }} Followers
      </span>
      <!--Display Following -->
      <span style="display: inline; padding: 1.5rem; font-weight: bold;" type="button" class="number-stat" data-toggle="modal" data-target="#exampleModal-2">
        {{ user_profile.following.count }} Following
      </span>

      <!-- Name and Username -->
      <div>
        <span>
        {{ user_profile.first_name }} {{ user_profile.last_name }} 
        <br>
        <small class="muted-text">@{{ user_profile.username }}</small>
        <br>
        <small class="muted-text"><i class="fa fa-birthday-cake" aria-hidden="true"></i> {{ user_profile.date_joined }}</small>
      </span>
        {% if user.is_authenticated and user != user_profile %}
        <!--Follow/Unfollow Buttons-->
        <span style="float: right;">
          <form action="{% url 'profile' user_profile.username %}" method="POST">
            {% csrf_token %}
            {% if following_profile %} 
            <input type="submit" value="Following" name="unfollow_button" class="btn following-button" id="unfollowButton">
            {% else %}
            <input type="submit" value="Follow" name="follow_button" class="btn follow_button" id="followButton">
            {% endif %}
          </form>
        </span>
        {% endif %}
      </div>
      
      </section>

    {% if user.is_authenticated %}
    <!-- Show All Following Modal -->
    <div class="modal fade" id="exampleModal-2" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel-2" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel-2">Following</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body text-center"> 
            {% for following in show_all_following %}
            <div>
            <a class="ml-1" href="{% url 'profile' following.user.username %}">{{ following.user }}</a>
          </div>
            {% empty %}
            Not Following Anyone
            <p></p>
            <!--Owl gif-->
            <div class="text-align center"> <img src="{% static 'network/images/owl.gif' %}" alt="owlgif" width="40%"></div>
            {% endfor %}
          </div>
          <div class="modal-footer">
          </div>
        </div>
      </div>
    </div>

    <!-- Show All Followers Modal -->
    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Followers</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body text-center"> 
            {% for followers in show_all_followers %}
            <div>
            <a class="ml-1" href="{% url 'profile' followers.follower.username %}">{{ followers.follower }}</a>
          </div>
            {% empty %}
            No Followers
            <p></p>
            <!--Owl gif-->
            <div class="text-align center"> <img src="{% static 'network/images/owl.gif' %}" alt="owlgif" width="40%"></div>
            {% endfor %}
          </div>
          <div class="modal-footer">
          </div>
        </div>
      </div>
    </div>
    {% endif %}

  </div>
</div>

{% include "network/hoot_posts.html" with posts=page_posts %}

<!--Pagination--> 
{% if page_posts.paginator.num_pages > 1 %}
<nav aria-label="Page navigation">
    <ul class="pagination" style="justify-content: center;">
      {% if page_posts.has_previous %}
          <li class="page-item"><a class="page-link" href="?page={{ page_posts.previous_page_number }}">Back</a></li>
          {% else %}
          <li class="page-item disabled"><a class="page-link" href="#">Back</a></li>
      {% endif %}
      <li class="page-item current-item"><span class="current page-link">
          {{ page_posts.number }} of {{ page_posts.paginator.num_pages }}
      </span></li>
      {% if page_posts.has_next %}
          <li class="page-item"><a class="page-link" href="?page={{ page_posts.next_page_number }}">Next</a></li>
      {% else %}
          <li class="page-item disabled"><a class="page-link" href="#">Next</a></li>
      {% endif %}
    </ul>
</nav>
{% endif %}
<!--Javascript link-->
<script src="{% static 'network/index.js' %}"></script>

{% endblock %}